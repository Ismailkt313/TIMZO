<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Timzo Admin - Categories</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

  <%- include('.././Partials/admin/navbar') %>

  <div class="flex min-h-screen">

    <div class="w-64 bg-dark text-white">
        <%- include('.././Partials/admin/adminsidebar', { activePage: 'categories' }) %>
    </div>
    <style>
        body {
          padding-top: 70px; 
        }
      </style>
    <main class="flex-1 p-6">
      

      <div class="bg-white p-4 rounded-xl shadow-md overflow-auto">
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-2xl font-bold">Categories</h1>
            <a href="/admin/addcategories" class="btn btn-primary">+ Add Category</a>
          </div>
        
        <table class="table table-bordered table-hover text-center">
          <thead class="table-dark">
            <tr>
              <th>#</th>
              <th>Name</th>
              <th>Offer (%)</th>
              <th>Description</th>
              <th>Sales</th>
              <th>Stock</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% if (categories.length > 0) { %>
              <% categories.forEach((category, index) => { %>
                <tr>
                  <td><%= index + 1 %></td>
                  <td><%= category.name %></td>
                  <td><%= category.offer %></td>
                  <td><%= category.description || '-' %></td>
                  <td><%= category.sales %></td>
                  <td><%= category.stock %></td>
                  <td>
                    <% if (category.isListed) { %>
                      <span class="text-success">Listed</span>
                    <% } else { %>
                      <span class="text-danger">Unlisted</span>
                    <% } %>
                  </td>
                  <td class="flex gap-2 justify-center">
                    <a href="/admin/editcategory/?id=<%= category._id %>" class="btn btn-sm btn-outline-warning" title="Edit">
                      <i class="bi bi-pencil-square"></i>
                    </a>
                  
                    <% if (category.isListed) { %>
                      <a href="/admin/listcategory?id=<%= category._id %>" class="btn btn-danger btn-sm">Unlist</a>
                    <% } else { %>
                      <a href="/admin/unlistcategory?id=<%= category._id %>" class="btn btn-success btn-sm">List</a>
                    <% } %>
                  
                    <form action="/admin/categories/delete/<%= category._id %>" method="POST" style="display:inline;" onsubmit="return confirm('Are you sure to delete this category?')">
                      <button type="submit" class="btn btn-sm btn-outline-danger">
                        <i class="bi bi-trash"></i>
                      </button>
                    </form>
                  </td>
                </tr>
              <% }); %>
            <% } else { %>
              <tr>
                <td colspan="8">No categories found.</td>
              </tr>
            <% } %>    
          </tbody>
        </table>
        <div class="d-flex justify-content-center">
          <nav aria-label="Page navigation">
              <ul class="pagination">
                  <% if (currentpage > 1) { %>
                      <li class="page-item">
                          <a class="page-link" href="/admin/categories?page=<%= currentpage - 1 %>">Previous</a>
                      </li>
                  <% } else { %>
                      <li class="page-item disabled">
                          <a class="page-link" href="#">Previous</a>
                      </li>
                  <% } %>
    
                  <% for (let i = 1; i <= totalPage; i++) { %>
                      <li class="page-item <%= currentpage === i ? 'active' : '' %>">
                          <a class="page-link" href="/admin/categories?page=<%= i %>"><%= i %></a>
                      </li>
                  <% } %>
      
                  <% if (currentpage < totalPage) { %>
                      <li class="page-item">
                          <a class="page-link" href="/admin/categories?page=<%= currentpage + 1 %>">Next</a>
                      </li>
                  <% } else { %>
                      <li class="page-item disabled">
                          <a class="page-link" href="#">Next</a>
                      </li>
                  <% } %>
              </ul>
          </nav>
      </div>
      
      </div>
    </main>
  </div>

  <!-- Footer -->
  <%- include('.././Partials/admin/footer') %>
  

</body>
</html>
